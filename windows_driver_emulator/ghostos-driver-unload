#!/bin/bash
# Heck-CheckOS Windows Driver Emulator - Unload Driver
# Usage: heckcheckos-driver-unload <driver_name>

if [ "$EUID" -ne 0 ]; then
    echo "Error: Must run as root"
    echo "Usage: sudo heckcheckos-driver-unload <driver_name>"
    exit 1
fi

if [ $# -lt 1 ]; then
    echo "Usage: heckcheckos-driver-unload <driver_name>"
    echo ""
    echo "Unload a Windows driver from the emulator"
    echo ""
    echo "Example:"
    echo "  sudo heckcheckos-driver-unload driver.sys"
    exit 1
fi

DRIVER_NAME="$1"

python3 /opt/heckcheckos/windows_driver_emulator/emulator.py unload "$DRIVER_NAME"
